<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Editable Table to Word</title>
    <script src="https://cdn.jsdelivr.net/npm/docx@7.1.1/build/index.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
  </head>
  <body>
    <table id="editableTable" border="1">
      <tr>
        <th>Column 1</th>
        <th>Column 2</th>
      </tr>
      <tr contenteditable="true">
        <td>Row 1 Col 1</td>
        <td>Row 1 Col 2</td>
      </tr>
      <tr contenteditable="true">
        <td>Row 2 Col 1</td>
        <td>Row 2 Col 2</td>
      </tr>
    </table>
    <button onclick="generateWordDocument()">Download as Word</button>

    <script>
      async function generateWordDocument() {
        const {
          Document,
          Packer,
          Paragraph,
          Table,
          TableRow,
          TableCell,
          TextRun,
        } = window.docx

        // Получаем данные из таблицы
        const table = document.getElementById('editableTable')
        const rows = table.rows

        // Создаем массив строк для docx таблицы с увеличенным шрифтом
        const docRows = Array.from(rows).map(
          (row) =>
            new TableRow({
              children: Array.from(row.cells).map(
                (cell) =>
                  new TableCell({
                    children: [
                      new Paragraph({
                        children: [
                          new TextRun({
                            text: cell.innerText,
                            size: 28, // Размер шрифта 24 (полутайповые пункты, 24 соответствует 12pt)
                          }),
                        ],
                      }),
                    ],
                  })
              ),
            })
        )

        // Создаем таблицу docx
        const docTable = new Table({
          rows: docRows,
        })

        // Создаем документ
        const doc = new Document({
          sections: [
            {
              properties: {},
              children: [docTable],
            },
          ],
        })

        // Генерируем и сохраняем документ
        try {
          const blob = await Packer.toBlob(doc)
          saveAs(blob, 'table.docx')
        } catch (err) {
          console.error('Error generating document:', err)
        }
      }
    </script>
  </body>
</html>